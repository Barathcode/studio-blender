= Formations tab
:imagesdir: ../../assets/images
:experimental:

The Formations tab in the sidebar of the 3D Viewport editor helps you to organize your animations and formations into a drone show.

image::panels/formations.jpg[Formations tab]


== Swarm panel

The swarm panel helps you setup your drone show with all technical parts that are not the sole responsibility of the drone show designer by default, such as the initial positions or the takeoff or landing procedures.

=== Drone collection

Click on the btn:[Drones] button to select the collection that is your primary source of your drone objects. By default you do not have to change this setting, the btn:[Create Takeoff Grid] button below will create a "Drones" collection and set it as your primary source automatically.

=== Max acceleration

The btn:[Max acceleration] button sets up a maximal acceleration (in all directions) that is used by the automated motion planning functions of *Skybrush Studio*, for example when automatic transitions or transition times are calculated.

=== Create Takeoff Grid

The btn:[Create Takeoff Grid] button helps you setup your takeoff and landing grid (they are expected to be the same by default).

image::panels/swarm/create_takeoff_grid.jpg[Create takeoff grid]

You can define the number of rows and columns, the exact number of drones and the spacing between them. Once you press btn:[OK], a rectangular grid is created with the specified parameters.

This operator also creates all Skybrush-specific collections (Drones, Formations, Templates) that you will need for your drone show, and will also initialize your drones in the 3D Viewport editor.


== Formations panel

With the Formations panel of the Formations tab you can create, select, deselect, update or remove formations or you can add them to your Storyboard.

=== Formation

Click on the btn:[Formation] button to edit a given formation in the Formations panel.

=== Create Formation

The btn:[+] button creates sub-collections in your Formations collection, consisting of objects that are to be animated during a given scene of your drone show.

image::panels/formations/create_formation.jpg[Create formation]

You can define a name for your new formation and select its initialization source. The source can be the actually selected objects, the selected vertices of an object, current positions of your drones or even an animated vertex group of an object.

=== Remove Selected Formation

Press the btn:[✕] button to remove the selected formation from the Formations list and Formations collection entirely.

=== Select Formation

Press the btn:[Select] button to add the selected formation to the selection.

=== Deselect Formation

Press the btn:[Deselect] button to remove the selected formation from the selection.

=== Formation Statistics

Press the btn:[Stats] button to show different useful statistics about the selected formation, such as the number of its elements, size or minimum distance between its objects on the current frame.

image::panels/formations/formation_stats.jpg[Formation stats]

=== Append to Storyboard

Press the btn:[Append to Storyboard] button to append the selected formation to the end of the show, planning the transition between the last formation and the new one.

=== Update

Press the btn:[Update] button to update the selected formation from the current selection or from the current positions of the drones.

image::panels/formations/update_formation.jpg[Update formation]


== Storyboard panel

The Storyboard gives you the overall structure of your drone show, with your formations ordered in time.

=== Create New Storyboard Entry

Press the btn:[+] button next to the formation list in the Storyboard to add a new entry to the end of the Storyboard.

=== Remove Selected Storyboard Entry

Press the btn:[-] button next to the formation list in the Storyboard to remove the selected storyboard entry from the list.

=== Select Storyboard Entry for Current Frame

Press the btn:[↥] button next to the formation list in the Storyboard to select the storyboard entry that contains the current frame. If the current frame falls between storyboard entries, the next entry will be selected. Pressing this button clears the selection if the current frame is after the end of the storyboard.

=== Move Selected Storyboard Entry Up

Press the btn:[▲] button next to the formation list in the Storyboard to move the selected entry up by one slot in the Storyboard.

=== Move Selected Storyboard Entry Down

Press the btn:[▼] button next to the formation list in the Storyboard to move the selected entry down by one slot in the Storyboard.

=== Formation

Select a formation corresponding the the selected Storyboard entry.

=== Start Frame

Set the frame when the given formation should start in the drone show.

=== Duration

Set the duration of the given formation in the drone show. The end frame of the formation will be `Start Frame + Duration`.

=== Transition

Set the type of transition between the previous formation and this one:

* Manual transitions map the nth vertex of the initial formation to the nth vertex of the target formation.

* Auto-matched transitions find an optimal mapping between vertices of the initial and the target formation.

=== Custom Name

If you check this, you can keep the name of the Storyboard entry when the associated formation changes.

=== Recalculate Transitions

Once you are satisfied with your storyboard, you can press the btn:[Recalculate Transitions] button to create automatic and optimal transitions between your formations without collisions.

image::panels/storyboard/recalculate_transitions.jpg[Recalculate Transitions]

This button also creates the constraints on your drones in your Drones collection to follow the given formations during their active time.